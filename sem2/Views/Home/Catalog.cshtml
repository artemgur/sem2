@using sem2.Views
@model IEnumerable<FilmDTO>

<link rel="stylesheet" href="~/css/collapse.css">

<div class="header-content">
    <div class="container">
        <div id="carouselExampleSlidesOnly" class="carousel slide" data-ride="carousel">
            <div class="carousel-inner">
                @{ var activeString = "active";}
                @foreach (var filmGroup in Model.Select(x => x.Id).GroupByN(3))
                {
                    <div class="carousel-item @activeString">
                        <div class="row <!--no-gutters-->">
                                <div class="col-4 item">
                                    <a class="btn d-block col-4" href="@Url.Content($"~/AboutFilm/{filmGroup[0]}")" aria-expanded="false" aria-controls="collapseExample">
                                        <div class="block_with_image">
                                            <div class="estimation_block">
                                                <p class="estimation">7,4</p>
                                                <img class="img-fluid" src="@Url.Content($"~/{FilmHelpers.BackgroundImagePath(filmGroup[0])}")" alt="">
                                            </div>
                                        </div>
                                    </a>
                                </div>
                                @if (filmGroup.Count > 1)
                                {
                                    <div class="col-4 item">
                                        <a class="btn d-block col-4" href="@Url.Content($"~/AboutFilm/{filmGroup[1]}")" aria-expanded="false" aria-controls="collapseExample">
                                            <div class="block_with_image">
                                                <div class="estimation_block">
                                                    <p class="estimation">7,4</p>
                                                    <img class="img-fluid" src="@Url.Content($"~/{FilmHelpers.BackgroundImagePath(filmGroup[1])}")" alt="">
                                                </div>
                                            </div>
                                        </a>
                                    </div>
                                }
                                @if (filmGroup.Count > 2)
                                {
                                    <div class="col-4 item">
                                        <a class="btn d-block col-4" href="@Url.Content($"~/AboutFilm/{filmGroup[2]}")" aria-expanded="false" aria-controls="collapseExample">
                                            <div class="block_with_image">
                                                <div class="estimation_block">
                                                    <p class="estimation">7,4</p>
                                                    <img class="img-fluid" src="@Url.Content($"~/{FilmHelpers.BackgroundImagePath(filmGroup[2])}")" alt="">
                                                </div>
                                            </div>
                                        </a>
                                    </div>
                                }
                            </div>                        
                    </div>
                    
                    
                    activeString = "";
                }
            </div>
                <a class="carousel-control-prev" href="#carouselExampleSlidesOnly" role="button" data-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="sr-only">Previous</span>
                </a>
                <a class="carousel-control-next" href="#carouselExampleSlidesOnly" role="button" data-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="sr-only">Next</span>
                </a>
        </div>
        <div id="products-container" class="row products">
            @foreach (var p in Model)
            {
                @Html.Partial("ProductCardPartial", p)
            }

            <!-- /.products-->
        </div>

        <!--</div> &lt;!&ndash; row &ndash;&gt;-->
    </div> <!-- Container -->
</div>	<!-- header-content -->

<script>
    $('#multiCarousel').carousel({
        interval: 10000
    })
    $('.carousel .carousel-item').each(function(){
        var next = $(this).next();
        if (!next.length) {
            next = $(this).siblings(':first');
        }
        next.children(':first-child').clone().appendTo($(this));

        for (var i=0;i<2;i++) {
            next=next.next();
            if (!next.length) {
                next = $(this).siblings(':first');
            }

            next.children(':first-child').clone().appendTo($(this));
        }
    });
</script>